# X-plan Demo 项目待办事项清单

## 📋 项目概览

- **项目名称**: X-plan Demo - 资产保护模拟演示
- **项目目标**: 模拟钱包私钥被盗场景，演示 Worker 抢先转移资产的保护机制
- **核心功能**:
  - 模拟私钥被盗后的资产转移攻击
  - Worker 自动监控和抢先转移资产
  - 应急状态开关控制（5秒高频扫描）
- **测试网络**: Polygon Amoy Testnet
- **当前状态**: 开发中
- **完成度**: ~30%

---

## 📍 核心钱包地址

### 地址 A - 被保护地址
- **用途**: 模拟私钥被盗，持有待保护的 XPD 代币
- **状态**: 私钥将在前端公示
- **文档**: `docs/wallet-addresses.md`

### 地址 B - 安全地址
- **用途**: Worker 转移资产的目标地址
- **状态**: 私钥保密，配置到 Worker

### 地址 C - Gas 费地址
- **用途**: 存储 POL，为 Worker 提供 Gas 费
- **状态**: 私钥保密，配置到 Worker

---

## 🎯 开发阶段规划

### 阶段一：基础设施准备 (Phase 1)

#### 1.1 钱包配置
- [x] 创建钱包地址文档
- [ ] 使用 ethers.js 生成真实钱包地址（A/B/C）
- [ ] 向地址 A 转移 XPD 代币（从已部署合约）
- [ ] 从水龙头获取 POL 并转移到地址 C
- [ ] 配置 Worker 环境变量（私钥 B 和 C）

#### 1.2 开发环境搭建
- [ ] 安装 Node.js 和 npm/yarn
- [ ] 创建前端项目（推荐使用 Next.js + TDesign）
- [ ] 初始化 Cloudflare Worker 项目
- [ ] 配置 Git 分支管理

---

### 阶段二：Cloudflare Worker 后端开发 (Phase 2)

#### 2.1 Worker 基础架构
- [ ] 初始化 Cloudflare Worker 项目结构
- [ ] 安装依赖（ethers.js、cron）
- [ ] 配置环境变量和密钥管理
- [ ] 设置 CORS 策略

#### 2.2 核心监控功能
- [ ] 实现地址 A 余额扫描函数
- [ ] 实现 XPD 代币余额查询（调用 ERC20 合约）
- [ ] 实现 POL 余额查询
- [ ] 添加余额阈值检测逻辑

#### 2.3 资产转移功能
- [ ] 实现代币转账函数（XPD → 地址 B）
- [ ] 实现 POL 转账函数（POL → 地址 C）
- [ ] 实现交易签名和发送
- [ ] 添加交易失败重试机制

#### 2.4 任务调度系统
- [ ] 配置常规任务（1分钟/次，仅监控）
- [ ] 配置应急任务（5秒/次，自动转移）
- [ ] 实现应急状态开关 API
- [ ] 添加任务日志记录

#### 2.5 API 接口开发
- [ ] GET `/api/status` - 获取当前应急状态
- [ ] POST `/api/emergency/start` - 启动应急状态
- [ ] POST `/api/emergency/stop` - 关闭应急状态
- [ ] GET `/api/balance` - 查询地址 A 余额
- [ ] GET `/api/logs` - 获取操作日志

---

### 阶段三：前端开发 (Phase 3)

#### 3.1 基础框架
- [ ] 初始化 Next.js 项目
- [ ] 集成 TDesign 组件库
- [ ] 配置路由和导航
- [ ] 实现基础布局（头部、侧边栏、主内容区）

#### 3.2 Web3 集成
- [ ] 安装和配置 ethers.js
- [ ] 实现钱包连接功能
- [ ] 实现私钥导入功能（测试用途）
- [ ] 添加网络切换（Polygon Amoy）
- [ ] 显示当前连接钱包信息

#### 3.3 核心页面开发

**首页 / Dashboard**
- [ ] 显示地址 A 的公钥和私钥（带安全警告）
- [ ] 实时显示地址 A 的 XPD 余额
- [ ] 实时显示地址 A 的 POL 余额
- [ ] 显示 Worker 应急状态
- [ ] 添加安全提示和使用说明

**资产转移测试页面**
- [ ] 导入私钥功能（用于攻击模拟）
- [ ] 输入目标地址
- [ ] 输入转移金额
- [ ] 发起转账按钮
- [ ] 显示转账结果（成功/失败）
- [ ] 显示交易哈希

**应急控制页面**
- [ ] 应急状态切换按钮（启动/关闭）
- [ ] 显示当前运行模式（常规/应急）
- [ ] 显示扫描频率（1分钟/5秒）
- [ ] 显示最近的保护操作日志

**监控日志页面**
- [ ] 显示所有 Worker 操作日志
- [ ] 日志筛选功能（按时间、类型）
- [ ] 导出日志功能
- [ ] 实时更新日志列表

#### 3.4 UI/UX 优化
- [ ] 实现响应式布局
- [ ] 添加加载动画
- [ ] 添加操作成功/失败提示
- [ ] 实现深色/浅色主题切换
- [ ] 优化移动端体验

---

### 阶段四：测试与验证 (Phase 4)

#### 4.1 功能测试
- [ ] 测试常规任务（关闭应急状态）
- [ ] 测试应急任务（开启应急状态）
- [ ] 测试手动转移成功场景
- [ ] 测试 Worker 抢先转移场景
- [ ] 测试 Gas 费不足场景
- [ ] 测试网络异常场景

#### 4.2 性能测试
- [ ] 测试 5 秒扫描的响应速度
- [ ] 测试并发请求处理能力
- [ ] 测试长时间运行的稳定性

#### 4.3 安全测试
- [ ] 验证地址 B 和 C 私钥未泄露
- [ ] 验证前端私钥导入功能的限制
- [ ] 验证 API 接口的访问控制

---

### 阶段五：部署与文档 (Phase 5)

#### 5.1 部署准备
- [ ] 配置 Cloudflare Worker 生产环境
- [ ] 配置域名和 SSL
- [ ] 部署前端到 Cloudflare Pages
- [ ] 配置环境变量（生产环境）

#### 5.2 文档完善
- [ ] 编写用户使用手册
- [ ] 编写部署指南
- [ ] 编写常见问题 FAQ
- [ ] 录制演示视频

#### 5.3 上线
- [ ] 最终功能验证
- [ ] 上线部署
- [ ] 监控运行状态

---

## 🚀 近期计划（本周 - 阶段一 + 阶段二开始）

### Day 1
- [ ] 生成真实的钱包地址 A、B、C
- [ ] 向地址 A 转移 XPD 代币
- [ ] 从水龙头获取 POL 并转移到地址 C
- [ ] 初始化 Cloudflare Worker 项目

### Day 2-3
- [ ] 配置 Worker 环境变量
- [ ] 实现基础余额扫描功能
- [ ] 实现代币转账功能
- [ ] 配置 Cron 任务调度

### Day 4-5
- [ ] 实现 API 接口
- [ ] 测试 Worker 基本功能
- [ ] 初始化前端项目
- [ ] 搭建前端基础框架

### Day 6-7
- [ ] 前端 Web3 集成
- [ ] 实现核心页面（Dashboard）
- [ ] 联调前后端
- [ ] 进行功能测试

---

## 🔧 技术栈确定

### 前端
- **框架**: Next.js 14 (App Router)
- **组件库**: TDesign
- **Web3 库**: ethers.js v6
- **状态管理**: React Hooks + Context API
- **样式**: Tailwind CSS

### 后端
- **平台**: Cloudflare Workers
- **语言**: JavaScript/TypeScript
- **Web3 库**: ethers.js v6
- **调度**: Cloudflare Cron Triggers
- **存储**: Cloudflare KV Databases (可选)

### 区块链
- **网络**: Polygon Amoy Testnet
- **代币合约**: XPD (已部署)
- **合约地址**: `0x35774A4E1fFEee74Fa3859F89cfae00b3aC8C3A8`
- **Gas 代币**: POL

---

## ⚠️ 已知问题和风险

- [ ] 钱包地址需使用真实生成的地址（当前为示例）
- [ ] Cloudflare Worker 需要配置环境变量存储私钥
- [ ] 5 秒高频扫描可能超出免费额度
- [ ] 测试网水龙头可能有请求限制
- [ ] Gas 费不足会导致保护失败

---

## 📝 重要备注

### 项目文档
- ✅ **项目背景**: `docs/项目背景.md` - 详细的功能说明和流程图
- ✅ **钱包地址**: `docs/wallet-addresses.md` - 地址配置说明
- ✅ **ERC20 合约**: `ERC20/README.md` - 代币合约文档

### 安全须知
⚠️ **重要**: 本项目仅用于 Polygon Amoy 测试网演示，切勿在主网使用真实资产！

### 下一步行动
1. 生成真实钱包地址 A、B、C
2. 初始化 Cloudflare Worker 项目
3. 开始开发后端监控和转移功能

---

## 🔗 相关资源

- [项目仓库](https://github.com/xplan2026/xplandemo)
- [Polygon Amoy 水龙头](https://faucet.polygon.technology/)
- [Cloudflare Workers 文档](https://developers.cloudflare.com/workers/)
- [ethers.js 文档](https://docs.ethers.org/)
- [TDesign React](https://tdesign.tencent.com/react/overview)
- [Pinme 文档](https://pinme.eth.limo/#/docs?id=getting-started)
---

最后更新: 2026-02-07
