# æœåŠ¡å™¨ç¯å¢ƒå®‰è£… - å¿«é€Ÿå¼€å§‹æŒ‡å—

æœ¬æ–‡æ¡£æä¾›å¿«é€Ÿé…ç½® Ubuntu æœåŠ¡å™¨ï¼ˆ182.254.180.26ï¼‰çš„æ­¥éª¤ã€‚

---

## ğŸ“‹ å‰ç½®æ¡ä»¶

- æœåŠ¡å™¨ IP: 182.254.180.26
- æ“ä½œç³»ç»Ÿ: Ubuntu 20.04
- æœ¬åœ°ç³»ç»Ÿ: Windows 10/11
- éœ€è¦ root å¯†ç 

---

## ğŸš€ æ–¹æ³•ä¸€ï¼šä¸€é”®éƒ¨ç½²ï¼ˆæ¨èï¼‰

### æ­¥éª¤ 1ï¼šè¿æ¥åˆ°æœåŠ¡å™¨

```bash
ssh root@182.254.180.26
```

è¾“å…¥ root å¯†ç ç™»å½•ã€‚

### æ­¥éª¤ 2ï¼šå…‹éš†ä»“åº“

```bash
cd /tmp
git clone https://github.com/xplan2026/xplandemo.git
cd xplandemo
```

### æ­¥éª¤ 3ï¼šè¿è¡Œä¸€é”®éƒ¨ç½²è„šæœ¬

```bash
bash server-configs/one-click-setup.sh
```

è„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆï¼š
- âœ… å®‰è£… Node.js, npm, Hardhat, Wrangler CLI
- âœ… å®‰è£… Nginx, PM2, http-server
- âœ… é…ç½®é˜²ç«å¢™
- âœ… å…‹éš†ä»“åº“
- âœ… é…ç½® Nginx
- âœ… åˆ›å»º Web ç›®å½•
- âœ… æç¤ºé…ç½® SSH Key

### æ­¥éª¤ 4ï¼šé…ç½® SSH Key

æŒ‰ç…§è„šæœ¬æç¤ºé…ç½® SSH Keyï¼š

**åœ¨æœ¬åœ° Windows æœºå™¨ä¸Š**ï¼š

```bash
# ç”Ÿæˆ SSH Key
ssh-keygen -t ed25519 -C "xplan2026@163.com" -f ~/.ssh/xplan_key

# å¤åˆ¶å…¬é’¥åˆ°æœåŠ¡å™¨
cat ~/.ssh/xplan_key.pub | ssh root@182.254.180.26 "cat >> ~/.ssh/authorized_keys"
```

**åœ¨æœåŠ¡å™¨ä¸Š**ï¼š

```bash
# è®¾ç½®æƒé™
chmod 600 ~/.ssh/authorized_keys
chmod 700 ~/.ssh
```

### æ­¥éª¤ 5ï¼šéªŒè¯å®‰è£…

```bash
# åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œ
node --version      # åº”æ˜¾ç¤º v20.x.x
npm --version       # åº”æ˜¾ç¤º 10.x.x
npx hardhat --version
wrangler --version

# æ£€æŸ¥ Nginx
systemctl status nginx

# æµ‹è¯• Web æœåŠ¡
curl http://localhost:6060
```

---

## ğŸ”§ æ–¹æ³•äºŒï¼šåˆ†æ­¥å®‰è£…

### æ­¥éª¤ 1ï¼šå®‰è£…ç¯å¢ƒ

```bash
cd /tmp/xplandemo
bash server-configs/install-server-environment.sh
```

### æ­¥éª¤ 2ï¼šé…ç½® Nginx

```bash
# å¤åˆ¶é…ç½®æ–‡ä»¶
cp server-configs/xplan-demo.conf /etc/nginx/sites-available/

# åˆ›å»ºç¬¦å·é“¾æ¥
ln -s /etc/nginx/sites-available/xplan-demo.conf /etc/nginx/sites-enabled/

# æµ‹è¯•é…ç½®
nginx -t

# é‡è½½ Nginx
systemctl reload nginx
```

### æ­¥éª¤ 3ï¼šé…ç½® SSH Key

æŒ‰ç…§æ–¹æ³•ä¸€çš„æ­¥éª¤ 4 æ‰§è¡Œã€‚

---

## ğŸ” SSH Key è¯¦ç»†é…ç½®

### æœ¬åœ°ç”Ÿæˆ SSH Key

```bash
# ç”Ÿæˆ ED25519 å¯†é’¥ï¼ˆæ¨èï¼‰
ssh-keygen -t ed25519 -C "xplan2026@163.com" -f ~/.ssh/xplan_key

# æˆ–ä½¿ç”¨ RSAï¼ˆå¦‚æœ ED25519 ä¸å¯ç”¨ï¼‰
ssh-keygen -t rsa -b 4096 -C "xplan2026@163.com" -f ~/.ssh/xplan_key
```

### å¤åˆ¶å…¬é’¥åˆ°æœåŠ¡å™¨

```bash
# æ–¹æ³• 1: ä½¿ç”¨ ssh-copy-idï¼ˆå¦‚æœæœ‰ï¼‰
ssh-copy-id -i ~/.ssh/xplan_key.pub root@182.254.180.26

# æ–¹æ³• 2: ä½¿ç”¨ç®¡é“
cat ~/.ssh/xplan_key.pub | ssh root@182.254.180.26 "cat >> ~/.ssh/authorized_keys"

# æ–¹æ³• 3: æ‰‹åŠ¨å¤åˆ¶
cat ~/.ssh/xplan_key.pub
# å¤åˆ¶è¾“å‡ºï¼Œç„¶ååœ¨æœåŠ¡å™¨ä¸Šï¼š
nano ~/.ssh/authorized_keys
# ç²˜è´´å¹¶ä¿å­˜
```

### æµ‹è¯• SSH Key ç™»å½•

```bash
# ä½¿ç”¨å¯†é’¥ç™»å½•ï¼ˆåº”è¯¥ä¸éœ€è¦å¯†ç ï¼‰
ssh -i ~/.ssh/xplan_key root@182.254.180.26
```

å¦‚æœæˆåŠŸç™»å½•ï¼Œè¯´æ˜ SSH Key é…ç½®æ­£ç¡®ï¼

---

## âš™ï¸ é…ç½® GitHub Actions Secrets

### æ­¥éª¤ 1ï¼šè¯»å–ç§é’¥

**åœ¨æœ¬åœ° Windows ä¸Š**ï¼š

```bash
# PowerShell
Get-Content $env:USERPROFILE\.ssh\xplan_key

# æˆ– Git Bash
cat ~/.ssh/xplan_key
```

å¤åˆ¶å®Œæ•´çš„ç§é’¥å†…å®¹ï¼ˆåŒ…æ‹¬ `-----BEGIN` å’Œ `-----END` è¡Œï¼‰ã€‚

### æ­¥éª¤ 2ï¼šæ·»åŠ  GitHub Secrets

è®¿é—®ï¼šhttps://github.com/xplan2026/xplandemo/settings/secrets/actions

æ·»åŠ ä»¥ä¸‹ Secretsï¼š

| Secret åç§° | å€¼ |
|-------------|-----|
| `SSH_PRIVATE_KEY` | [ç²˜è´´å®Œæ•´çš„ç§é’¥å†…å®¹] |
| `SSH_HOST` | `182.254.180.26` |
| `SSH_USER` | `root` |
| `CLOUDFLARE_API_TOKEN` | [ä½ çš„ Cloudflare API Token] |
| `CLOUDFLARE_ACCOUNT_ID` | [ä½ çš„ Cloudflare Account ID] |
| `PINATA_API_KEY` | [ä½ çš„ Pinata API Key] |
| `PINATA_API_SECRET` | [ä½ çš„ Pinata API Secret] |
| `PINATA_JWT` | [ä½ çš„ Pinata JWT] |

### æ­¥éª¤ 3ï¼šæµ‹è¯• GitHub Actions

åˆ›å»ºæµ‹è¯•å·¥ä½œæµ `.github/workflows/test-ssh.yml`ï¼š

```yaml
name: Test SSH

on:
  workflow_dispatch:

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - name: SSH Connect
        uses: appleboy/ssh-action@master
        with:
          host: ${{ secrets.SSH_HOST }}
          username: ${{ secrets.SSH_USER }}
          key: ${{ secrets.SSH_PRIVATE_KEY }}
          script: |
            echo "SSH è¿æ¥æˆåŠŸï¼"
            hostname
            whoami
```

æ¨é€ä»£ç ï¼Œåœ¨ GitHub Actions ä¸­æ‰‹åŠ¨è§¦å‘æµ‹è¯•ã€‚

---

## ğŸ“Š éªŒè¯å®‰è£…

### æ£€æŸ¥è½¯ä»¶ç‰ˆæœ¬

```bash
# åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œ
echo "=== Node.js ==="
node --version

echo "=== npm ==="
npm --version

echo "=== Hardhat ==="
npx hardhat --version

echo "=== Wrangler ==="
wrangler --version

echo "=== PM2 ==="
pm2 --version

echo "=== Nginx ==="
nginx -v

echo "=== Git ==="
git --version
```

### æ£€æŸ¥æœåŠ¡çŠ¶æ€

```bash
# Nginx
systemctl status nginx

# é˜²ç«å¢™
ufw status

# å¼€æ”¾çš„ç«¯å£
netstat -tlnp | grep -E ':(22|80|443|6060)'
```

### æ£€æŸ¥ç›®å½•ç»“æ„

```bash
# é¡¹ç›®ç›®å½•
ls -la /opt/xplan/

# Web ç›®å½•
ls -la /var/www/

# Nginx é…ç½®
ls -la /etc/nginx/sites-enabled/
```

---

## ğŸ¯ åç»­æ­¥éª¤

### 1. éƒ¨ç½²å‰ç«¯åº”ç”¨

**æ–¹å¼ 1ï¼šè‡ªåŠ¨éƒ¨ç½²ï¼ˆæ¨èï¼‰**

```bash
# åœ¨æœ¬åœ°æ¨é€ä»£ç 
git add .
git commit -m "æ›´æ–°ä»£ç "
git push origin master
```

GitHub Actions ä¼šè‡ªåŠ¨éƒ¨ç½²åˆ°æœåŠ¡å™¨ã€‚

**æ–¹å¼ 2ï¼šæ‰‹åŠ¨éƒ¨ç½²**

```bash
# åœ¨æœåŠ¡å™¨ä¸Š
cd /tmp/xplandemo
bash server-configs/deploy-frontend.sh
```

### 2. éƒ¨ç½² Cloudflare Workers

æ¨é€ä»£ç åˆ° `cloudflare/` ç›®å½•ï¼ŒGitHub Actions ä¼šè‡ªåŠ¨éƒ¨ç½²ã€‚

### 3. ç›‘æ§æœåŠ¡å™¨

```bash
# è¿è¡Œå¥åº·æ£€æŸ¥
bash server-configs/check-server-health.sh

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
tail -f /var/log/nginx/access.log
tail -f /var/log/nginx/error.log
```

### 4. è®¿é—®åº”ç”¨

```
Official Site: http://182.254.180.26:6060
DemoSite: http://182.254.180.26:6060/demo/
```

---

## ğŸ› ï¸ æ•…éšœæ’æŸ¥

### é—®é¢˜ 1ï¼šNode.js å®‰è£…å¤±è´¥

```bash
# æ‰‹åŠ¨å®‰è£… NodeSource ä»“åº“
curl -fsSL https://deb.nodesource.com/setup_20.x | bash -
apt install -y nodejs
```

### é—®é¢˜ 2ï¼šNginx æ— æ³•å¯åŠ¨

```bash
# æ£€æŸ¥é…ç½®
nginx -t

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
journalctl -u nginx -n 50

# é‡å¯ Nginx
systemctl restart nginx
```

### é—®é¢˜ 3ï¼šSSH Key æ— æ³•ç™»å½•

```bash
# æ£€æŸ¥æƒé™
chmod 600 ~/.ssh/xplan_key
chmod 600 ~/.ssh/authorized_keys

# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
ssh -v root@182.254.180.26
```

### é—®é¢˜ 4ï¼šGitHub Actions è¿æ¥å¤±è´¥

1. ç¡®è®¤ GitHub Secrets é…ç½®æ­£ç¡®
2. æ£€æŸ¥æœåŠ¡å™¨é˜²ç«å¢™ï¼š`ufw status`
3. éªŒè¯ SSH Keyï¼š`ssh -i ~/.ssh/xplan_key root@182.254.180.26`

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **SSH Key è¯¦ç»†é…ç½®**: `temp/SSH-Key-é…ç½®æŒ‡å—.md`
- **å®Œæ•´éƒ¨ç½²æŒ‡å—**: `docs/éƒ¨ç½²æŒ‡å—/å®Œæ•´çš„éƒ¨ç½²é…ç½®.md`
- **Ubuntu Server Manager Skill**: `.codebuddy/skills/ubuntu-server-manager/`
- **æ•…éšœæ’æŸ¥æŒ‡å—**: `.codebuddy/skills/ubuntu-server-manager/references/troubleshooting-guide.md`

---

## âœ… å®‰è£…æ¸…å•

å®Œæˆä»¥ä¸‹æ£€æŸ¥ï¼Œç¡®è®¤å®‰è£…æˆåŠŸï¼š

- [ ] Node.js å·²å®‰è£…ï¼ˆv20.x.xï¼‰
- [ ] npm å·²å®‰è£…ï¼ˆ10.x.xï¼‰
- [ ] Hardhat å·²å®‰è£…
- [ ] Wrangler CLI å·²å®‰è£…
- [ ] Nginx å·²å®‰è£…å¹¶è¿è¡Œ
- [ ] PM2 å·²å®‰è£…
- [ ] é˜²ç«å¢™å·²é…ç½®
- [ ] Web ç›®å½•å·²åˆ›å»º
- [ ] SSH Key å·²é…ç½®
- [ ] GitHub Secrets å·²é…ç½®
- [ ] æµ‹è¯• SSH è¿æ¥æˆåŠŸ
- [ ] æµ‹è¯• GitHub Actions è¿æ¥æˆåŠŸ
- [ ] æµ‹è¯• Web æœåŠ¡å¯è®¿é—®

---

**æ–‡æ¡£åˆ›å»ºæ—¥æœŸ**: 2026-02-08
**æœåŠ¡å™¨ IP**: 182.254.180.26
**æ“ä½œç³»ç»Ÿ**: Ubuntu 20.04
**ç›®æ ‡ç¯å¢ƒ**: Node.js 20.x, npm, Hardhat, Wrangler CLI, Nginx
